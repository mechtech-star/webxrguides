import { Signal } from '@preact/signals-core';
export type GetSignal<T> = T extends Signal<infer K> ? K : T;
export type NotUndefined<T> = T extends undefined ? never : T;
export type ReadonlyProperties<Out> = {
    get value(): Out;
    peek(): Out;
    get signal(): {
        [Key in keyof Out]-?: Signal<Out[Key]>;
    };
    /**
     * allows to subcribe to all the current and new property keys
     * @param callback is called immediately for all the current property keys
     */
    subscribePropertyKeys(callback: (key: string | symbol | number) => void): () => void;
};
export type Properties<In, Out extends object> = ReadonlyProperties<Out> & {
    destroy(): void;
    set<K extends keyof In>(layerIndex: number, key: K, value: In[K]): void;
    setLayer(index: number, value: Partial<In> | undefined): void;
};
export declare class PropertiesImplementation<In, Out extends object> implements Properties<In, Out> {
    private readonly apply;
    private readonly defaults?;
    private readonly onLayerIndicesChanged?;
    private enabled;
    readonly value: Out;
    readonly signal: { [Key in keyof Out]-?: Signal<Out[Key]>; };
    readonly peekProxy: Out;
    private propertyStateMap;
    protected propertiesLayers: Map<number, Record<keyof Out, any>>;
    private propertyKeys;
    private propertyKeySubscriptions;
    constructor(apply: <K1 extends keyof In>(key: K1, value: In[K1], set: <K2 extends keyof Out>(key: K2, value: Out[K2] | Signal<Out[K2]>) => void, layerIndex: number) => void, defaults?: { [Key in keyof Out]: Out[Key] | Signal<Out[Key]>; } | undefined, onLayerIndicesChanged?: (() => void) | undefined);
    peek(): Out;
    subscribePropertyKeys(callback: (key: string | symbol | number) => void): () => void;
    private clearProvidedLayer;
    setLayer(index: number, value: Partial<In> | undefined): void;
    private getSignal;
    private peekValue;
    set<K extends keyof In>(layerIndex: number, key: K, value: In[K]): void;
    private setProperty;
    private update;
    setEnabled(enabled: boolean): void;
    private updateAll;
    destroy(): void;
}
