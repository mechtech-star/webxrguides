{"version":3,"file":"index.js","sources":["../../../../../../../../../../../node_modules/.pnpm/@pmndrs+uikitml@0.1.7_super-three@0.177.0/node_modules/@pmndrs/uikitml/dist/interpreter/index.js"],"sourcesContent":["import { Container, Image, Input, Text, Video, Svg, StyleSheet, Textarea } from '@pmndrs/uikit';\nimport { computed } from '@preact/signals-core';\nimport { htmlKit } from './html.js';\nexport function interpret(parseResult, kit) {\n    if (!parseResult.element) {\n        return null;\n    }\n    // Add parsed CSS classes to the global StyleSheet\n    for (const [className, classData] of Object.entries(parseResult.classes)) {\n        if (classData && typeof classData === 'object' && 'content' in classData) {\n            StyleSheet[className] = classData.content;\n        }\n    }\n    const kitEntries = Object.entries(htmlKit);\n    if (kit != null) {\n        kitEntries.unshift(...Object.entries(kit));\n    }\n    return interpretElement(parseResult.element, kitEntries);\n}\nfunction interpretElement(json, kit) {\n    if (json === null || json === undefined) {\n        return null;\n    }\n    if (typeof json === 'string') {\n        const text = new Text({\n            text: computed(() => (text.parentContainer.value?.properties.value).text ?? json),\n            width: '100%',\n            height: '100%',\n        });\n        return text;\n    }\n    const properties = { ...json.properties };\n    if (properties.style && typeof properties.style === 'object') {\n        Object.assign(properties, properties.style);\n        delete properties.style;\n    }\n    const elementId = properties.id;\n    let element;\n    switch (json.type) {\n        case 'container':\n            element = createContainerElement(json, properties);\n            break;\n        case 'custom':\n            element = createCustomElement(json, properties, kit);\n            break;\n        case 'image':\n            element = createImageElement(json, properties);\n            break;\n        case 'svg':\n            element = createSvgElement(json, properties);\n            break;\n        case 'inline-svg':\n            element = createInlineSvgElement(json, properties);\n            break;\n        case 'video':\n            element = createVideoElement(json, properties);\n            break;\n        case 'input':\n            element = createInputElement(json, properties);\n            break;\n        case 'textarea':\n            element = createTextareaElement(json, properties);\n            break;\n        default:\n            //omit the kit intentionally because we are falling back to an unknown uikit kit component\n            element = createCustomElement(json, properties);\n            break;\n    }\n    if (elementId) {\n        element.userData.id = elementId;\n    }\n    if (json.sourceTag) {\n        element.userData.sourceTag = json.sourceTag;\n    }\n    if (json.dataUid) {\n        element.userData.dataUid = json.dataUid;\n    }\n    // Preserve data-* attributes in userData, removing data prefix and lowercasing first letter\n    for (const [key, value] of Object.entries(properties)) {\n        if (key.startsWith('data')) {\n            // Remove 'data' prefix and lowercase the first letter of the remaining part\n            const userDataKey = key.slice(4, 5).toLowerCase() + key.slice(5);\n            element.userData[userDataKey] = value;\n        }\n    }\n    if (properties.class) {\n        const classNames = properties.class.split(' ').filter((name) => name.trim());\n        element.classList.add(...classNames);\n    }\n    if (element instanceof Container) {\n        ;\n        json.children.forEach((childElementJson) => {\n            const childElement = interpretElement(childElementJson, kit);\n            if (childElement) {\n                element.add(childElement);\n            }\n        });\n    }\n    return element;\n}\nfunction createContainerElement(_json, properties) {\n    return new Container(properties);\n}\nfunction createCustomElement(json, properties, kit) {\n    const componentName = json.sourceTag;\n    const CustomComponent = kit == null ? undefined : kit.find(([name]) => name.toLowerCase() === componentName)?.[1];\n    if (CustomComponent) {\n        const element = new CustomComponent(properties);\n        element.userData.customElement = {\n            componentName,\n            sourceTag: json.sourceTag,\n        };\n        return element;\n    }\n    else {\n        const element = new Container(properties);\n        element.userData.customElement = {\n            componentName,\n            sourceTag: json.sourceTag,\n        };\n        //console.warn(`Custom component '${componentName}' not found in kit, falling back to Container`)\n        return element;\n    }\n}\nfunction createImageElement(_json, properties) {\n    if (!properties.src) {\n        console.warn('Image element missing src property');\n        properties.src = '';\n    }\n    return new Image(properties);\n}\nfunction createSvgElement(_json, properties) {\n    if (!properties.src) {\n        console.warn('SVG element missing src property');\n        properties.src = '';\n    }\n    return new Svg(properties);\n}\nfunction createInlineSvgElement(json, properties) {\n    const svgText = json.text || '';\n    return new Svg({\n        ...properties,\n        content: svgText,\n    });\n}\nfunction createVideoElement(_json, properties) {\n    if (!properties.src) {\n        console.warn('Video element missing src property');\n        properties.src = '';\n    }\n    return new Video(properties);\n}\nfunction createTextareaElement(_json, properties) {\n    return new Textarea(properties);\n}\nfunction createInputElement(_json, properties) {\n    return new Input(properties);\n}\nexport function getElementDescription(json) {\n    if (typeof json === 'string') {\n        return `Text: \"${json.substring(0, 20)}${json.length > 20 ? '...' : ''}\"`;\n    }\n    switch (json.type) {\n        case 'container':\n            return `Container (${json.sourceTag})`;\n        case 'custom':\n            return `Custom: ${json.sourceTag}`;\n        case 'image':\n            return `Image: ${json.properties?.src || 'no src'}`;\n        case 'svg':\n            return `SVG: ${json.properties?.src || 'no src'}`;\n        case 'inline-svg':\n            return `Inline SVG (${json.text?.length || 0} chars)`;\n        case 'video':\n            return `Video: ${json.properties?.src || 'no src'}`;\n        case 'input':\n        case 'textarea':\n            return `Input (${json.sourceTag}${json.properties?.multiline ? ', multiline' : ''})`;\n        default:\n            return `Unknown: ${json.type}`;\n    }\n}\n//# sourceMappingURL=index.js.map"],"names":[],"mappings":"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","x_google_ignoreList":[0]}